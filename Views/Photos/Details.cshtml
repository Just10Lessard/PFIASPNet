@model PhotosManager.Models.Photo
@{
    ViewBag.Title = "Détails de photo";

    int userId = ((PhotosManager.Models.User)Session["ConnectedUser"]).Id;

    bool userLike = PhotosManager.Models.DB.Likes.ToList().Exists(l => (l.PhotoId == Model.Id && l.UserId == userId));

    string photoLikedByConnectedUser = userLike ? "fa" : "fa-regular";

    int currentPhotoId = Model.Id;     //(int)Session["currentPhotoId"]; le prof veut faire session mais je Model.id pour le moment
    var user = ((PhotosManager.Models.User)Session["ConnectedUser"]);

}

<div class="content">
    <div class="photoDetailsOwner">
        <div class="UserSmallAvatar" style="background-image:url('@Model.Owner.Avatar')" title="@Model.Owner.Name"></div>
        @Model.Owner.Name
    </div>
    <hr>
    <div class="photoDetailsTitle">@Model.Title</div>
    <img src="@Model.Image" class="photoDetailsLargeImage">
    <div class="photoDetailsCreationDate">
        @Helper.When(Model.CreationDate, true)
        <div class="likesSummary">
            @Model.Comments.Count()
            <i class="cmdIconSmall fa-regular fa-comment" title="@Model.CommentsUserList"></i>
            @Model.Likes.Count()
            <a href="/Photos/TogglePhotoLike/@Model.Id"
               style="text-decoration:none; font-size:1.1em"
               class="cmdIconSmall @photoLikedByConnectedUser fa-thumbs-up"
               id="addRemoveLikeCmd"
               title="@Html.Raw(Model.UsersLikesList)">
            </a>
        </div>
        <div class="photoDetailsDescription">@Model.Description</div>
    </div>
</div>
<div id="DetailsPanel"> <!-- Auto refreshed --></div>
<hr />
<!-- Create new comment command icon -->
<div class="commentFooter ">
    <h4 style="margin-left:22px;">Commentaires</h4>
    <div class="commentSubFooter" style="font-size:1em">
        <i class="newCommentCmd cmdIcon fa-regular fa-comment" style="margin-top:-3px; z-index:1;font-size:1.5em" parentId="0" title="Ajouter un commentaire"></i>
    </div>
</div>
<details open style="position:relative; top:-40px;" id="commentDetails">
    <summary style="border: none; background: none; "></summary>
    <!-- All comments rendering -->
    <div class="commentsSection" id="commentsSection"> <!-- auto refreshed --> </div>
    <!-- Hidden programmatically new comment UI -->
    <div class="newCommentLayout" photoId="@currentPhotoId" createCommentparentId="0">
        <div class="UserSmallAvatar" style="background-image:url('@user.Avatar')" title="@user.Name"></div>
<textarea class="form-control" rows="1" placeholder="commenter"></textarea>
        <div></div>
        <div class="editCommentFooter">
            <div></div>
            <!-- Commit create command icon -->
            <span class="createCommentCmd cmdIconSmall fa fa-check" parentId="0"></span>
            <!-- Abort update command icon -->
            <span class="abortCreateCommentCmd cmdIconSmall fa fa-times" parentId="0"></span>
        </div>
    </div>
</details>

